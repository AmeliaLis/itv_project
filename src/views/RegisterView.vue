<template>
    <div>
        <div>To jest strona z rejestracjÄ…</div>
        <h1>Create an account</h1>
        <p v-if="this.validationErrors">{{ this.validationErrors }}</p>
        <p><input type="text" placeholder="Email" v-model="email" /></p>
        <p><input type="password" placeholder="Password" v-model="password" /></p>
        <p><button @click="registerOnSubmit">Submit</button></p>
        <p><button @click="signInWithGoogle">Sign in with Google</button></p>
    </div>
</template>


<script>
import { actionTypes } from "@/store/modules/authentication"
import { getAuth, signInWithPopup, GoogleAuthProvider } from "firebase/auth";
import { mapState } from "vuex";


export default {
    name: "RegisterView",
    data() {
    return {
        email: "",
        password: "",
        };
    },
    computed: {
    ...mapState({
        validationErrors: (state) => state.authentication.validationErrors,
    }),
    },
    methods: {
        registerOnSubmit(){
            this.$store.dispatch(actionTypes.register, {
                email: this.email,
                password: this.password
            })
            .then(() => {
                this.$router.push({ name: "feed" });
            })    
        },
        
        signInWithGoogle() {
            const provider = new GoogleAuthProvider();
            signInWithPopup(getAuth(), provider)
                .then((result) => {
                    console.log(result.user);
                    this.$router.push({ name: "feed"});
                })
                .catch((error) => {
                    console.log(error.code)
                })
        }

    },
}
</script>